\begin{figure}
%\medskip
\begin{lstlisting}
	var customer= {Id:"", couponStatus:"default", payable:0, ...};
	var coupon= {Id:"", expired:false...}
	var availItems= {{name:"", count:0}}
	...
	$document.ready(function() {
		...	
		$('#couponButt').click(selectItem);
		$('#viewCart').click(viewCart);
	});
	
	function selectItem() {
		var coupElem= $('#couponButt');
		var selItem= {name:"", price:0, quantity:0};
		selItem= getSelectedItem($('.merchandise');
		for(var i=0; i<availItems.length; i++){
			if(availItems[i].name == selItem.name)
				availItems[i].count -= selItem.quantity;		
		}
		var price= selItem.price * selItem.quantity;
		coupon= getCouponFromServer(url + customer.Id);
		if(!coupon.expired){
			coupElem.removeClass(customer.couponStatus);
			customer.couponStatus= coupon.Id + '-' + 'used';
			price -= coupElem.data('value');	
			coupElem.addClass(customer.couponStatus);	
		} 	
		customer.payable += price;
	}

	function viewCart(){
		...
		if(customer.payable==0 && customer.couponStatus == 'default')
			showMsg('Shopping cart is empty');
		else
			$("#cart").append('Total purchase is: ' + "$" + customer.payable);
	}


\end{lstlisting}
\vspace{-0.1in} 

\caption{\javascript code of the running example.}
\label{Fig:example}
\vspace{-0.2in} 

\end{figure}